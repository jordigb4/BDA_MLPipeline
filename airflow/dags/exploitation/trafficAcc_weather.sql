CREATE OR REPLACE VIEW experiment3 AS
SELECT
    t."dr_no",
    DATE(t.date_occ) AS date_occ,
    DATE(t.date_rptd) AS date_rptd,
    t."time_occ",
    'reseda' AS area_name,
    t."latitude",
    t."longitude",
    t."rpt_dist_no",
    t."mocodes",
    t."vict_age",
    t."vict_sex",
    t."vict_descent",
    t."premis_cd",
    t."location",
    t."cross_street",
    w."TMAX",
    w."TMIN",
    w."PRCP"
FROM trusted_trafficAcc_reseda t
LEFT JOIN trusted_weather_reseda w
    ON DATE(t.date_occ) = DATE(w.datetime_iso)

UNION

SELECT
    t."dr_no",
    DATE(t.date_occ) AS date_occ,
    DATE(t.date_rptd) AS date_rptd,
    t."time_occ",
    'downtown' AS area_name,
    t."latitude",
    t."longitude",
    t."rpt_dist_no",
    t."mocodes",
    t."vict_age",
    t."vict_sex",
    t."vict_descent",
    t."premis_cd",
    t."location",
    t."cross_street",
    w."TMAX",
    w."TMIN",
    w."PRCP"
FROM trusted_trafficAcc_downtown t
LEFT JOIN trusted_weather_downtown w
    ON DATE(t.date_occ) = DATE(w.datetime_iso)

UNION

SELECT
    t."dr_no",
    DATE(t.date_occ) AS date_occ,
    DATE(t.date_rptd) AS date_rptd,
    t."time_occ",
    'long_beach' AS area_name,
    t."latitude",
    t."longitude",
    t."rpt_dist_no",
    t."mocodes",
    t."vict_age",
    t."vict_sex",
    t."vict_descent",
    t."premis_cd",
    t."location",
    t."cross_street",
    w."TMAX",
    w."TMIN",
    w."PRCP"
FROM trusted_trafficAcc_long_beach t
LEFT JOIN trusted_weather_long_beach w
    ON DATE(t.date_occ) = DATE(w.datetime_iso)